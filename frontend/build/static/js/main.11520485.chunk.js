(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,n){e.exports=n(323)},210:function(e,t,n){},317:function(e,t){},323:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(30),l=n(15),c=n(20),s=n(23),i=n(21),u=n(24),h=(n(210),n(40)),m=n(16),d={background:"#FFF",height:"64px",paddingRight:"20px"},p=(n(68),n(103)),b={styleButton:{margin:"0px 50px 10px auto",fontWeight:"800",padding:"5px",border:"#1565C0",borderStyle:"solid",borderRadius:"10%",backgroundColor:"#EA9A40"}},g=Object(p.a)({transition:"color .2s",color:"black",$nest:{"&:hover":{color:"white"}}}),f=function(e){return a.createElement(h.b,Object.assign({to:"/load"},e))},C=function(e){return a.createElement(h.b,Object.assign({to:"/search"},e))};var v=function(){return a.createElement("div",null,a.createElement(m.c,{style:d},a.createElement(m.b,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},a.createElement(m.b,{item:!0,sm:9,xs:8,style:{paddingTop:"20px",textAlign:"center"}},a.createElement(m.a,{component:f,className:g,variant:"contained",style:b.styleButton},"Load"),a.createElement(m.a,{component:C,className:g,variant:"contained",style:b.styleButton},"Search")))))},E=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.createElement("div",null,a.createElement(v,null),a.createElement("title",null,"Prodigium"),a.createElement("meta",{name:"description",content:""}),a.createElement("h1",null,"Prodigium Contact Search"))}}]),t}(a.Component),S=n(49),y=n(2),x=n.n(y),O=n(32),w=n(10),k=n(8),j=n(102),N=n.n(j),F=(n(320),Object({NODE_ENV:"production",PUBLIC_URL:"."}).PORT||3300),B="http://localhost:".concat(F);function D(e){return A.apply(this,arguments)}function A(){return(A=Object(w.a)(x.a.mark(function e(t){var n,a,o,r,l=arguments;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},a={"Content-type":"application/json; charset=UTF-8"},console.log("sR: ".concat(B).concat(t)),e.next=5,fetch(encodeURI("".concat(B).concat(t)),Object.assign({method:"POST",credentials:"include"},{headers:a},n));case 5:return o=e.sent,e.next=8,o.json();case 8:if(!(r=e.sent).error){e.next=11;break}throw new Error(r.error);case 11:return console.log("sR got data: ",r),e.abrupt("return",r);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return I.apply(this,arguments)}function I(){return(I=Object(w.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getList: /categories"),e.next=3,D("/categories",{method:"GET"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G(){return R.apply(this,arguments)}function R(){return(R=Object(w.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getLoadDate"),e.next=3,D("/loadDate",{method:"GET"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M(e){return P.apply(this,arguments)}function P(){return(P=Object(w.a)(x.a.mark(function e(t){var n,a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log("getContacts: /contacts"),n="",console.log("asSS: ",t),a=0;a<t.length-1;a++)console.log("string build: ",a,t[a]),n+=t[a],n+="@";return n+=t[a],console.log("string finish: ",a,t[a]),e.next=8,D("/contacts?q=".concat(n),{method:"GET"});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}console.log("NODE_ENV: ".concat("production"," dev: ").concat(!0));var T,W=n(50),_=n.n(W);var V=[{key:"GivenName",name:"GivenName"},{key:"FamilyName",name:"FamilyName"}];var U,H,J=Object(a.createRef)(),$={margin:20,verticalAlign:"top",display:"inline-block"},q=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).timeCounter=void 0,n.names=void 0,n.state=void 0,n.handleSubmit=n.handleSubmit.bind(Object(k.a)(n)),n.setState=n.setState.bind(Object(k.a)(n)),n.timeCounter=0,n.names=[],n.state={timeCounter:0,response:!1},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(w.a)(x.a.mark(function e(){var t,n=this;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getting socket"),(t=N()("http://localhost:9900")).on("news",function(e){console.log("something received: ",e);for(var a=JSON.parse(e.something),o=0;o<a.length;o++){var r={};r.id=o,r.GivenName=a[o].GivenName,r.FamilyName=a[o].FamilyName,n.names.push(r)}t.close(),window.clearInterval(T),n.setState(function(e){return Object(O.a)({},e,{response:!0})})}),t.on("progress",function(e){U=e.progress,console.log("Value: ",e.progress)});case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),null!==J&&null!==J.current&&null!==J.current.files){console.log("load button"),console.log("props: ",this.props),console.log("state: ",this.state);var n=new FormData,a=J.current.files[0];console.log("fileName: ",J),console.log("fname: ",a),n.append("avatar",a),n.append("clearDB",this.props.bClearDB.toString()),n.append("clearCats",this.props.bClearCats.toString()),null!==J&&null!==J.current?n.append("csv",J.current.name.indexOf("csv")>0?"true":"false"):n.append("csv","false"),console.log("formdata: ",n),T=window.setInterval(function(){t.timeCounter++,t.setState({timeCounter:t.timeCounter})},1e3),fetch("/contacts/import",{method:"PUT",body:n}).then(function(e){return e.text()}).then(function(e){console.log("res: ",e)})}}},{key:"render",value:function(){return o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("label",null,"Upload file:",o.a.createElement("input",{style:{width:"100%"},accept:".csv, .CSV, .vcf, .VCF",type:"file",ref:J})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("button",{type:"submit"},o.a.createElement("strong",null,"Submit")),o.a.createElement("div",null,this.state.response?o.a.createElement("div",null,o.a.createElement("p",null,"Loading done."),o.a.createElement("p",null,"Near-duplicates:"),o.a.createElement("div",{style:$},this.names.length>0?(e=this.names,o.a.createElement(_.a,{minWidth:500,columns:V,rowGetter:function(t){return e[t]},rowsCount:e.length,enableCellSelect:!1,minHeight:420})):"")):o.a.createElement("p",null,"Loading: ",U,"%")));var e}}]),t}(o.a.Component),z=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).handleInputChange=function(e){console.log("Input change",e.target.name,e.target.type,e.target.checked),n.setState(function(t){return Object(O.a)({},t,Object(S.a)({},e.target.name,e.target.checked))})},n.handleInputChange=n.handleInputChange.bind(Object(k.a)(n)),n.state={bClearCats:!1,bClearDB:!1,date:""},n.handleInputChange=n.handleInputChange.bind(Object(k.a)(n)),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(w.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("CDM before gLD call"),e.next=4,G();case 4:t=e.sent,console.log("CDM:",t),this.setState({date:t}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e={width:"16px",height:"16px"};return o.a.createElement("strong",null,o.a.createElement("div",{style:{margin:"0 20px"}},v(),o.a.createElement("style",null,'\n      body {\n        background-image: url("/static/media/oriental.png");\n      }\n      '),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("h2",{style:{textAlign:"left"}},"Load contacts (last loaded ",this.state.date,")"),o.a.createElement("form",null,o.a.createElement("label",null,"Empty the database before loading: ",o.a.createElement("input",{style:e,name:"bClearDB",type:"checkbox",checked:this.state.bClearDB,onChange:this.handleInputChange})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("label",null,"Rebuild the categories file: ",o.a.createElement("input",{style:e,name:"bClearCats",type:"checkbox",checked:this.state.bClearCats,onChange:this.handleInputChange})),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement(q,{bClearDB:this.state.bClearDB,bClearCats:this.state.bClearCats})))}}]),t}(o.a.Component),K=function e(){Object(l.a)(this,e),this.sSearch="",this.asSelect=[],this.bNext=!1,this.bAnd=!1,this.bSearch=!0,this.sSubCatOf="",this.iCatSearches=0,this.bComplete=!1,this.aoCatsList=[],this.sCat=[],this.bAllowMult=!1,this.iCatSearchesMax=0},Q={bottom:0,left:20,right:0,maxWidth:600,maxHeight:350,backgroundColor:"rgba(0,0,0,0.3)",padding:50},X={backgroundColor:"#fff",borderRadius:5,maxWidth:500,minHeight:200,margin:"0 auto",padding:30},Y={margin:20,verticalAlign:"top",display:"inline-block"},Z={margin:20,verticalAlign:"top",display:"inline-block"},ee=[],te=[];te[0]=new K,te[0].bNext=!0,console.log("aoS original length: ",te.length);var ne=[],ae=0,oe=[{key:"GivenName",name:"GivenName"},{key:"FamilyName",name:"FamilyName"}],re=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(i.a)(t).call(this,e))).state=void 0,n.catAddSelect=function(e,t){console.log("Need to debug this"),te[t].sCat=[].filter.call(e.target.options,function(e){return e.selected}).map(function(e){return e.value}),console.log("catAddSelect: ",te[t].sCat)},n.andButton=function(e){return function(){te[e].bAnd=!1,te[e].bSearch=!1,console.log("AND iCatSearches: ",te[e].iCatSearches),te[++ae-1]=new K,te[ae-1].bNext=!0,n.setState({iCounter:n.state.iCounter++})}},n.nextButton=function(e){return function(){console.log("next button: ",e,te[e].iCatSearches),te[e].iCatSearches++,""!==te[e].sSearch&&(te[e].sSearch+=" _ "),te[e].iCatSearches<3&&te[e].sCat.length<2?(console.log("sCat: ",te[e].sCat),console.log("sCat length: ",te[e].sCat.length),te[e].bComplete=!1,te[e].iCatSearches>0&&(te[e].bAnd=!0)):(te[ae-1].bComplete=!0,te[ae-1].bAnd=!1,te[ae-1].bNext=!1,te[ae-1].bSearch=!1,te[++ae-1]=new K,te[ae-1].bNext=!0),te[e].sSearch+=te[e].sCat.join(" OR "),console.log("searchString: ",te[e].sSearch),te[e].sSubCatOf=te[e].sCat[0],console.log("asSubCatOf: ",te[e].sCat[0]),H?n.searchButton():n.setState({iCounter:n.state.iCounter++})}},n.state={list:[],loading:!0,sAddCat:[],aoFound:[],iCounter:0,iPersonShow:-1},console.log("constructor aoFound: ",n.state.aoFound),n.nextButton=n.nextButton.bind(Object(k.a)(n)),n.andButton=n.andButton.bind(Object(k.a)(n)),n.searchButton=n.searchButton.bind(Object(k.a)(n)),ee[0]=0,n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"onClose",value:function(){}},{key:"ModalBox",value:function(e){return console.log("ModalBox: ",ne[e].GivenName),a.createElement("div",{className:"backdrop",style:Q},a.createElement("div",{className:"modal",style:X},a.createElement("div",null,a.createElement("p",null,ne[e].GivenName," ",ne[e].FamilyName)),a.createElement("p",null,void 0!==ne[e].FC_ID1?a.createElement("a",{target:"_blank",href:ne[e].url},a.createElement("strong",null,"FullContact")):""),a.createElement("p",null,ne[e]["Phone1-Value"],"\xa0\xa0",ne[e]["E-mail1-Value"]),a.createElement("br",null),a.createElement("img",{alt:"",style:{height:120},src:ne[e].Photo1}),a.createElement("div",{className:"footer"})))}},{key:"rowSel",value:function(e){console.log("Row: ",e),this.setState({iPersonShow:e}),console.log("iPS: ",this.state.iPersonShow)}},{key:"NameTable",value:function(e){var t=this;return a.createElement(_.a,{minWidth:500,columns:oe,rowGetter:function(t){return e[t]},rowsCount:e.length,enableCellSelect:!0,onCellSelected:function(e){return t.rowSel(e.rowIdx)},minHeight:420})}},{key:"componentDidMount",value:function(){var e=Object(w.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,ae=1,H=!1,console.log("CDM before gL call"),e.next=6,L();case 6:t=e.sent,console.log("CDM:",t),this.setState({list:t,loading:!1}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),this.setState({loading:!1});case 14:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"searchButton",value:function(){var e=Object(w.a)(x.a.mark(function e(){var t,n,a,o,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log("Search button"),H=!0,t=[],n=0;n<ae;n++)t[n]=te[n].sSearch;return e.next=6,M(t);case 6:for(a=e.sent,console.log("aoFound: ",a.aoFound),this.setState({aoFound:a.aoFound}),o=0;o<a.aoFound.length;o++)(r={}).id=o,r=a.aoFound[o],ne.push(r);return console.log(ne),e.abrupt("return");case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"csr",value:function(e){for(var t=this,n=0;n<ae;n++){if(console.log("iTR, iRow, iCatSearches: ",ae,n,te[n].iCatSearches),te[n].aoCatsList=[],te[n].iCatSearches<3){console.log("aoS[iR].sSCO: ",te[n].sSubCatOf);for(var o=0,r=0;r<e.list.aoCats.length;r++)e.list.aoCats[r].sIsSubCatOf===te[n].sSubCatOf&&(te[n].aoCatsList.push(e.list.aoCats[r]),te[n].aoCatsList[o].key=o++);te[n].aoCatsList.sort(function(e,t){return e.sThisCat>t.sThisCat?1:-1})}te[n].bAllowMult=""!==te[n].sSubCatOf,te[n].aoCatsList.length<2&&(console.log("short row: ",n,te[n].aoCatsList.length),te[n].bComplete=!0,te[n].bNext=!1,te[n].iCatSearchesMax=2)}var l=[];console.log("csr aoFound 1: ",e.aoFound),e.aoFound!==[]?(console.log("csr aoFound 2: ",e.aoFound),(l=e.aoFound).sort(function(e,t){return e.FamilyName>t.FamilyName?1:t.FamilyName>e.FamilyName?-1:e.GivenName>t.GivenName?1:t.GivenName>e.GivenName?-1:0})):l=[];for(var c=0;c<l.length;c++)l[c].url="https://app.fullcontact.com/contacts/".concat(l[c].FC_ID1,"/").concat(l[c].FC_ID2);return console.log("aoSearch len",te.length),console.log("aoCatsList: ",te[0].aoCatsList),a.createElement("div",{style:{textAlign:"center",margin:"0 20px"}},v(),a.createElement("h2",null,"Search page"),a.createElement("strong",null,te.map(function(e,n){return a.createElement("div",{key:n},a.createElement("div",null,a.createElement("p",null,e.sSearch)),e.bComplete?"":a.createElement("div",null,a.createElement("select",{size:10,multiple:!!e.bAllowMult,onChange:function(e){return t.catAddSelect(e,n)}},e.aoCatsList.map(function(e,t){return a.createElement("option",{key:t}," ",e.sThisCat," ")}))),a.createElement("div",null,e.bNext?a.createElement("button",{onClick:t.nextButton(n)},"Next"):""),a.createElement("div",null,e.bAnd?a.createElement("button",{onClick:t.andButton(n)},"AND"):""),a.createElement("div",null,e.bSearch?a.createElement("button",{onClick:t.searchButton},"Search"):""))}),a.createElement("br",null),a.createElement("div",{style:Y},l.length>0?this.NameTable(l):""),a.createElement("div",{style:Z},this.state.iPersonShow>=0?this.ModalBox(this.state.iPersonShow):""),a.createElement("div",null)))}},{key:"render",value:function(){return console.log("render CSRWD: |",Object(O.a)({},this.state)),a.createElement("div",null," ",this.csr(Object(O.a)({},this.state))," ")}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=n(22);r.render(a.createElement(h.a,null,a.createElement(le.c,null,a.createElement(le.a,{exact:!0,path:"/",component:E}),a.createElement(le.a,{path:"/load",component:z}),a.createElement(le.a,{path:"/search",component:re}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},68:function(e,t,n){}},[[205,1,2]]]);
//# sourceMappingURL=main.11520485.chunk.js.map